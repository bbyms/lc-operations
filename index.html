<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Operations 2017</title>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400|Oswald:600,700" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <main>
    <section class="cover">
      <h1>Operations 2017</h1>

    </section>

    <section class="intro grid">
      <div class="content">
        <h1>Intro</h1>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptates, deserunt facilis et iste corrupti omnis tenetur est. Iste ut est dicta dolor itaque adipisci, dolorum minima, veritatis earum provident error molestias. Ratione magni illo sint vel velit ut excepturi consectetur suscipit, earum modi accusamus voluptatem nostrum, praesentium numquam, reiciendis voluptas sit id quisquam. Consequatur in quis reprehenderit modi perspiciatis necessitatibus saepe, quidem, suscipit iure natus dignissimos ipsam, eligendi deleniti accusantium, rerum quibusdam fugit perferendis et optio recusandae sed ratione. Culpa, dolorum reprehenderit harum ab voluptas fuga, nisi eligendi natus maiores illum quas quos et aperiam aut doloremque optio maxime fugiat doloribus. Eum dolorum expedita quam, nesciunt</p>
      </div>

      <img src="http://unsplash.it/800/800" class="align-right slide-in">
    </section>

    <section class="map">
      <h1>Map</h1>
    </section>

    <section class="map-highlighted grid">

      <div class="">
        <h1 id="bangladesh-figure">
          400
        </h1>
        <label for="">days</label>
      </div>

      <div class="">
        <h1>
          <span id="bangladesh-hubs">25000</span>
          <small>m<sup>3</sup></small>
        </h1>

        <label for="">relief items</label>
      </div>

    </section>

    <section class="country grid">
      <img src="images/bangladesh.jpg" class="align-left slide-in">

      <div class="content">
        <h1>Bangladesh</h1>

        <p>In August 2017, within the space of a single month, 500,000 Rohingya people fled Myanmar’s Rakhine state seeking safety in Bangladesh. After one year, it is estimated that the number of new arrivals has risen to 720,000 people. Humanitarian organisations operating in Cox’s Bazar, in support of the government-led response, currently target 1.3 million people for humanitarian assistance, including host communities in the area. </p>

        <p>Since the start of its operation in Bangladesh, the Logistics Sector has been acting as a coordination mechanism supporting over sixty humanitarian organisations and government institutions with critical common services and key logistics information, including access constrains maps. </p>

        <p>While working on the immediate response, the Logistics Sector has also been supporting organisations with their preparedness activities. The exposure to natural hazards, including heavy rains during monsoon and cyclone seasons which cause flooding and infrastructure damage, coupled with the temporary nature of many settlements and shelters represent a continuous challenge to the humanitarian logistics operations. Year-round preparedness is therefore necessary. </p>

        <p>In close collaboration with humanitarian partners, the Logistics Sector has facilitated the establishment of free-to-user storage space in three logistics hubs in Cox’s Bazar: Ukhiya and Madhu Chara, both provided by WFP, and Teknaf, managed by Handicap International/Atlas Logistique. In total, 18 MSUs have been made available as common storage for the humanitarian community. </p>

        <p>Since the start of the operation in September 2017, the Logistics Sector has coordinated storage of XX m3 of relief items, including more than two million soap bars and 250,000 blankets, for XX different actors such as national and international NGOs, and UN agencies. </p>

        <p>The common facilities have also been used to preposition relief items for the monsoon season preparation plans and further support has been provided by loaning 20 containers in several locations for the storage of rapid response goods.</p>

        <p>In parallel, the Logistics Sector has been advocating with authorities for the implementation of procedures, such as truck weight limits, to ensure road access is maintained and relief cargo can reach key locations within and around the camps and makeshift settlements.  </p>

        <p>In addition, WFP and Better Shelter led two training courses, with a total of 28 participants from 13 organisations, on the topics of warehouse management and assembly of prefabricated shelters, to strengthen the capacity of actors on the ground.</p>

        <p>The operating environment remains extremely variable. Adaptive coordination, effective assessment and information management activities, as well as a focus on resilience and capacity building are critical going into 2019. The Logistics Sector is working with partners to review its support and to define the scale up that may be required in case of a cyclone affecting Cox’s Bazar.</p>
      </div>
    </section>

    <section class="back">
      social networks
    </section>
  </main>

  <script>


  function animateValue(id, start, end, duration) {
    // assumes integer values for start and end

    var obj = document.getElementById(id);
    var range = end - start;
    // no timer shorter than 50ms (not really visible any way)
    var minTimer = 50;
    // calc step time to show all interediate values
    var stepTime = Math.abs(Math.floor(duration / range));

    // never go below minTimer
    stepTime = Math.max(stepTime, minTimer);

    // get current time and calculate desired end time
    var startTime = new Date().getTime();
    var endTime = startTime + duration;
    var timer;

    function run() {
      var now = new Date().getTime();
      var remaining = Math.max((endTime - now) / duration, 0);
      var value = Math.round(end - (remaining * range));
      obj.innerHTML = value;
      if (value == end) {
        clearInterval(timer);
      }
    }

    timer = setInterval(run, stepTime);
    run();
  }

  function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
  }

  const test = numberWithCommas('7200000');

  console.log(test);

  function debounce(func, wait = 20, immediate = true) {
    var timeout;
    return function() {
      var context = this, args = arguments;
      var later = function() {
        timeout = null;
        if (!immediate) func.apply(context, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, args);
    };
  }

  const sliderImages = document.querySelectorAll('.slide-in');

  function checkSlide(e) {
    sliderImages.forEach(sliderImage => {
      // half way through the image
      const slideInAt = (window.scrollY + window.innerHeight) - sliderImage.height / 2;
      // bottom of the image
      const imageBottom = sliderImage.offsetTop + sliderImage.height;

      const isHalfShown = slideInAt > sliderImage.offsetTop;
      const isNotScrolledPast = window.scrollY < imageBottom;

      if(isHalfShown && isNotScrolledPast) {
        sliderImage.classList.add('active');
        animateValue('bangladesh-figure', 100, 400, 3000);
        animateValue('bangladesh-hubs', 0, 25000, 3000);
      } else {
        sliderImage.classList.remove('active');
      }

    });
  }

  window.addEventListener('scroll', debounce(checkSlide));

  </script>

</body>
</html>
